{"version":3,"sources":["../node_modules/promise-polyfill/src/finally.js","../node_modules/promise-polyfill/src/index.js"],"names":["finallyConstructor","callback","constructor","then","value","resolve","reason","reject","Promise","setTimeoutFunc","setTimeout","noop","bind","fn","thisArg","apply","arguments","TypeError","_state","_handled","_value","undefined","_deferreds","doResolve","handle","self","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","e","promise","push","newValue","finale","length","_unhandledRejectionFn","i","len","Handler","done","ex","prototype","prom","promiseFinally","all","arr","args","Array","slice","call","remaining","res","val","race","values","setImmediate","err","console","warn"],"mappings":"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","file":"src.6af2468a.map","sourceRoot":"../src","sourcesContent":["/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n"]}