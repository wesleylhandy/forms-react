{"version":3,"sources":["node_modules/promise-polyfill/src/finally.js","node_modules/promise-polyfill/src/index.js"],"names":["finallyConstructor","callback","constructor","then","value","resolve","reason","reject","setTimeoutFunc","setTimeout","noop","bind","fn","thisArg","apply","arguments","Promise","TypeError","_state","_handled","_value","undefined","_deferreds","doResolve","handle","self","deferred","push","_immediateFn","cb","onFulfilled","onRejected","promise","ret","e","newValue","finale","length","_unhandledRejectionFn","i","len","Handler","done","ex","prototype","prom","promiseFinally","all","arr","args","Array","slice","call","remaining","res","val","race","values","setImmediate","err","console","warn"],"mappings":"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","file":"src.7aaf042a.map","sourceRoot":"..","sourcesContent":["/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n"]}